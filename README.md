# Backblaze Data Analysis

A collection of scripts to prepare and process data published by Backblaze, to
generate failure rate curves over the age of a disk. The scripts needed for the
final generation of plots are kept in [failure-analysis repo][].

The steps described below assumes the presence of directories `2014`, `2015`,
`2016` and `2017` within [`data` directory][], containing [Hard Drive Test Data
from Backblaze][backblaze] in csv format (i.e. after extracted them).

[failure-analysis repo]: https://gitlab.com/johncf/failure-analysis
[`data` directory]: ./data
[backblaze]: https://www.backblaze.com/b2/hard-drive-test-data.html

### Prepare Database: `dbpopulate.sh`

`dbpopulate.sh`, when executed, will create a Postgres database named
`backblaze` and a table named `raw_logs` in it. It proceeds to populate it with
data from [`data` directory][].

This uses `filter_csv.py` to create a csv file each for every month, which only
contains those fields necessary for the database. It then performs a [`COPY`][]
from the newly created csv file into the `raw_logs` table.

[`COPY`]: https://www.postgresql.org/docs/current/static/sql-copy.html

### Process Data: `process.sh`

`process.sh` crunches the data to produce two output files: `fails.csv` and
`obs.csv`. These files can be passed to `basic-plot.py` script from
[failure-analysis repo][failure-analysis] to generate annualized failure rate plot
against the age of the disk for the model of interest specified in `views.sql`.

Edit `views.sql` before running this if you want to specify another disk model
of interest. At the time of writing this, there was only one disk model with
enough data to generate a failure rate curve with low noise.

[failure-analysis]: https://gitlab.com/johncf/failure-analysis

### Results

Below are the plots generated by [`basic-plot.py`][] for various disk models
from Backblaze dataset. In the plots below, power-on hours from data is
converted to power-on years. Thus the resulting failure rate is on an yearly
basis; more specifically, the unit we use is "Annualized Failure Rate" (AFR) in
percentage.

[`basic-plot.py`]: https://gitlab.com/johncf/failure-analysis/blob/master/basic-plot.py

#### Seagate ST4000DM000

**Total disk-years observed:** 87,647 <br>
**Total failures observed:** 2,587 <br>
**Mean AFR over lifetime:** 3.0%

![fr-1](https://i.imgur.com/Z5c9fEB.png)

**Comments:** Failure rate seems to have a steadily increasing trend as disks age.

#### Seagate ST3000DM001

**Total disk-years observed:** 3,481 <br>
**Total failures observed:** 1,454 <br>
**Mean AFR over lifetime:** 42%

![fr-2](https://i.imgur.com/BanAPND.png)

**Comments:** Abnormally high failure rate (note the Y-scale). The graph below
shows the number of failures reported daily for this model which is too high
for the number of disks deployed.

![fpd-2](https://i.imgur.com/aQFithX.png)

For comparison, the same for the previous model is shown below.

![fpd-1](https://i.imgur.com/QLwuqOW.png)

This _might_ be due to the failure detection system being too conservative and
marking disks "failed" due to events/measures that the manufacturer might
consider "normal."

#### Seagate ST31500541AS

**Total disk-years observed:** 2,825 <br>
**Total failures observed:** 274 <br>
**Mean AFR over lifetime:** 9.7%

![fr-3](https://i.imgur.com/JOTCdtD.png)

**Comments:** The failure rate graph is too noisy due to lack of data, but it
seems to have an almost constant (or slightly decreasing) failure rate over
first 6 years of age.

#### Hitachi HDS722020ALA330

**Total disk-years observed:** 11,898 <br>
**Total failures observed:** 202 <br>
**Mean AFR over lifetime:** 1.7%

![fr-4](https://i.imgur.com/0xNIsJz.png)

**Comments:** The first half is very noisy since most of the disks are more
than 3 years old. The failure rate remained low at around 2% for the span of
age we had significant data of.

#### WDC WD30EFRX

**Total disk-years observed:** 3,301 <br>
**Total failures observed:** 166 <br>
**Mean AFR over lifetime:** 5.0%

![fr-5](https://i.imgur.com/VkJI32r.png)

**Comments:** The failure rate seems to have a decreasing trend over age,
dropping from around 7% during the first year to around 2% in the third year.

### Conclusions

More than 10,000 disk-years of observation seems to be needed to generate
low-noise plots of failure rate over age of a hard drive model.

No hard generalizations can be made about the pattern of failure rate over age,
such as constant/increasing/decreasing, for all drive models.
